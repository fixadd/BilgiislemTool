{% extends "base.html" %}
{% block title %}Ana Sayfa{% endblock %}
{% block content %}
<h1>Fabrika Envanteri</h1>
<div class="row">
  {% for factory, categories in factories.items() %}
  <div class="col-md-4 mb-3">
    <div class="card">
      <div class="card-header">{{ factory }}</div>
      <ol class="list-group list-group-flush list-group-numbered">
        {% for cat in categories %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ cat.kategori }}
          <span class="badge bg-primary rounded-pill">{{ cat.adet }}</span>
        </li>
        {% endfor %}
      </ol>
    </div>
  </div>
  {% endfor %}
</div>

<div class="mt-4">
  <h2>Donanım Dağılımı</h2>
  <canvas id="hardwareChart"></canvas>
</div>

<div class="mt-4">
  <h2>Son İşlemler</h2>
  <div class="card">
    <ol class="list-group list-group-flush list-group-numbered">
      {% for log in actions %}
      <li class="list-group-item">
        {{ log.timestamp }} - {{ log.username }} = {{ log.action }}
      </li>
      {% endfor %}
    </ol>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('hardwareChart');
new Chart(ctx, {
  type: 'pie',
  data: {
    labels: {{ type_labels | tojson }},
    datasets: [{
      data: {{ type_counts | tojson }},
      backgroundColor: [
        '#ff6384', '#36a2eb', '#ffce56', '#4bc0c0', '#9966ff', '#ff9f40'
      ],
    }]
  }
});
</script>
{% endblock %}

